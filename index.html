<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Перенаправление</title>
</head>
<body>

<script>

function fallbackCopyLinkToClipboard(text) {
  var textArea = document.createElement("textarea");
  textArea.value = text;

  // Стиль "display: none" прячет элемент от пользователя.
  textArea.style.position = "fixed";
  textArea.style.top = 0;
  textArea.style.left = 0;

  // Убедимся, что элемент не мешает видимости страницы и пользовательскому взаимодействию.
  textArea.style.opacity = 0;

  document.body.appendChild(textArea);
  textArea.focus();
  textArea.select();

  try {
    var successful = document.execCommand('copy');
    var msg = successful ? 'successful' : 'unsuccessful';
    console.log('Fallback: Copying text command was ' + msg);
    alert('Ссылка успешно скопирована!');
  } catch (err) {
    console.error('Fallback: Oops, unable to copy', err);
    alert('Не удалось скопировать ссылку!');
  }

  document.body.removeChild(textArea);
}


function getDevice() {
  const userAgent = navigator.userAgent.toLowerCase();
  if (/android/i.test(userAgent)) {
    return 'android';
  } else if (/iphone|ipad|ipod/i.test(userAgent)) {
    return 'ios';
  } else {
    return 'desktop';
  }
}

async function saveLinkToClipboard() {
  if (navigator.clipboard) {
    try {
      await navigator.clipboard.writeText(currentPageUrl);
      alert('Ссылка успешно скопирована!');
    } catch (error) {
      console.error('Ошибка при копировании ссылки:', error);
      alert('Не удалось скопировать ссылку!');
    }
  } else {
    // Используйте альтернативный метод для устаревших браузеров
    fallbackCopyLinkToClipboard(currentPageUrl);
  }
}

function redirectToLink(link) {
  window.location.href = link;
}

const currentPageUrl = window.location.href;

saveLinkToClipboard();

const device = getDevice();

switch (device) {
  case 'android':
    redirectToLink('https://play.google.com/store/apps/details?id=com.alfredtheapp.alfred');
    break;
  case 'ios':
    redirectToLink('https://apps.apple.com/us/app/alfredstay/id6450202202');
    break;
  case 'desktop':
    redirectToLink('https://www.alfredtheapp.com/');
    break;
}

</script>

</body>
</html>

